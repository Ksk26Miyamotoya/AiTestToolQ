# AiTestToolQ よくある質問 (FAQ)

## 基本的な質問

### Q: AiTestToolQとは何ですか？
A: AiTestToolQはSeleniumベースのウェブアプリケーション自動テストツールです。複数ユーザーでの同時アクセステスト、スクリーンショット撮影、Excelレポート生成などの機能を備えています。

### Q: どのようなブラウザに対応していますか？
A: Chrome、Firefox、Edge、Safariに対応しています。設定ファイル（config.toml）の`browser`パラメータで指定できます。

### Q: 必要なPythonのバージョンは？
A: Python 3.12以上が必要です。それより古いバージョンでは動作しない可能性があります。

## インストールと設定

### Q: インストール方法を教えてください
A: 以下の手順でインストールできます：
```bash
# 仮想環境の作成と有効化
python -m venv venv
# Windows
venv\Scripts\activate
# macOS/Linux
source venv/bin/activate

# 必要なパッケージをインストール
pip install -r requirements.txt
```

### Q: 設定ファイルはどのように作成すればよいですか？
A: 設定ファイルはTOML形式で作成します。`resources/config.toml`をテンプレートとして使用し、必要に応じて修正してください。URL設定、ユーザー設定、シナリオ設定は別ファイルで管理します。

### Q: 設定ファイルの拡張子は必ず.tomlにする必要がありますか？
A: はい、設定ファイルは必ずTOML形式（.toml拡張子）で作成してください。拡張子がない場合は自動的に.tomlが追加されますが、明示的に指定することをお勧めします。

## 実行と使用方法

### Q: 基本的な実行方法を教えてください
A: プロジェクトのルートディレクトリから以下のコマンドで実行できます：
```bash
python -m src
```

### Q: ブラウザを表示しながらテストを実行するには？
A: `--test-mode`オプションを使用します：
```bash
python -m src --test-mode
```
または、config.tomlの`test_mode`を`true`に設定します。

### Q: 特定の設定ファイルを使用するには？
A: コマンドラインオプションで指定できます：
```bash
python -m src --url-config resources/url/staging --user-config resources/user/test_user --scenario-config resources/scenario/login_only.csv
```

### Q: テスト実行速度を調整できますか？
A: はい、config.tomlの`action_delay`パラメータで各アクション間の遅延時間を秒単位で設定できます。また、`slow_mode`を`true`に設定するとデバッグ用の遅延モードになります。

## シナリオファイル

### Q: シナリオファイルの形式は？
A: シナリオファイルはCSV形式で、各行が1つのテストアクションを表します。基本的な列は「操作ID」「操作タイプ」「対象要素」「入力値」「説明」です。

### Q: サポートされている操作タイプは？
A: 主な操作タイプには以下があります：
- `URL移動`: 指定したURLに移動
- `テキスト入力`: 要素にテキストを入力
- `クリック`: 要素をクリック
- `強制クリック`: JavaScriptを使用して要素を強制的にクリック
- `JSクリック`: JavaScriptを使用して要素をクリック
- `選択`: ドロップダウンから選択
- `待機`: 指定時間待機
- `アサート`: 要素の存在や値を検証
- `スクリプト実行`: JavaScriptを実行

詳細は[シナリオファイル](scenario.md)のドキュメントを参照してください。

### Q: 要素の指定方法は？
A: 要素はCSSセレクタ、XPath、ID、名前などで指定できます。例：
- `css:#login-button`（CSSセレクタ）
- `xpath://button[@type="submit"]`（XPath）
- `id:username`（ID）
- `name:password`（名前）

## スクリーンショットとレポート

### Q: スクリーンショットはいつ撮影されますか？
A: config.tomlの`screenshot_timing`設定に基づいて撮影されます。デフォルトでは「アクション前」「アクション後」「エラー時」に撮影されます。

### Q: Excelレポートにはどのような情報が含まれますか？
A: Excelレポートには以下の情報が含まれます：
- テスト概要（実行日時、ブラウザ、成功/失敗数など）
- セッション一覧
- 各セッションの詳細（アクション一覧、結果）
- スクリーンショット（Before/After）

### Q: レポートのカスタマイズは可能ですか？
A: はい、config.tomlで以下の設定をカスタマイズできます：
- `report_title`: レポートのタイトル
- `company_name`: 会社名
- `project_name`: プロジェクト名
- `report_logo`: ロゴ画像のパス
- 各種色設定（ヘッダー、成功/失敗セルなど）

## トラブルシューティング

### Q: テストが失敗する場合はどうすればよいですか？
A: 以下を確認してください：
1. 要素のセレクタが正しいか
2. タイムアウト設定が適切か（config.tomlの`timeout`パラメータ）
3. `output/[タイムスタンプ]/screenshot`ディレクトリのエラー時のスクリーンショットを確認
4. ログ出力を確認（`debug_mode = true`に設定するとより詳細なログが出力されます）

### Q: 「要素が見つかりません」というエラーが発生する
A: 以下の原因が考えられます：
1. セレクタが間違っている
2. 要素が読み込まれる前にアクセスしている（`wait`操作を追加してみてください）
3. 要素がiframeの中にある（iframe切り替えが必要）
4. 動的に生成される要素の場合、JavaScriptの実行完了を待つ必要がある

### Q: Excelレポートが正しく表示されない
A: 以下を確認してください：
1. openpyxlとPillowがインストールされているか
2. 会社名やプロジェクト名に特殊文字が含まれていないか
3. ロゴ画像のパスが正しいか
4. 十分なディスク容量があるか

### Q: 同時実行テストで問題が発生する
A: 同時実行テストでは以下の点に注意してください：
1. システムリソース（メモリ、CPU）が十分か
2. テスト対象のサーバーが同時アクセスに対応しているか
3. テストユーザー間で競合が発生していないか（例：同じデータを更新するなど）

## 開発と拡張

### Q: 新しい操作タイプを追加するには？
A: `src/action_handler.py`を修正し、新しい操作タイプに対応するメソッドを追加します。詳細は[開発者向け情報](development.md)を参照してください。

### Q: 他のブラウザドライバを追加するには？
A: `src/browser_session.py`の`_initialize_driver`メソッドを修正して、新しいブラウザドライバの初期化コードを追加します。

### Q: テスト結果の出力形式をカスタマイズするには？
A: `src/utils/excel_report.py`を修正して、Excelレポートの生成ロジックをカスタマイズできます。また、新しい出力形式（例：HTML、PDF）を追加する場合は、新しいモジュールを作成してください。

## その他

### Q: 複数環境（開発、ステージング、本番）でのテスト実行はどうすればよいですか？
A: 各環境用のURL設定ファイルを作成し、コマンドラインオプションで切り替えます：
```bash
# 開発環境
python -m src --url-config resources/url/development

# ステージング環境
python -m src --url-config resources/url/staging

# 本番環境
python -m src --url-config resources/url/production
```

### Q: CIツールと統合できますか？
A: はい、Jenkins、GitHub Actions、GitLab CIなどのCIツールと統合できます。ヘッドレスモードで実行するには、config.tomlの`test_mode`を`false`に設定してください。

### Q: 大規模なテストスイートの管理方法は？
A: 以下の方法をお勧めします：
1. 機能ごとにシナリオファイルを分割する
2. 共通操作を別ファイルにまとめる
3. テスト実行を自動化するスクリプトを作成する
4. テスト結果を集約して分析するツールを導入する
