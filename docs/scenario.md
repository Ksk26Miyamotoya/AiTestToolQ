# シナリオファイル

シナリオファイルは、テスト実行時に行うアクションを定義するCSVファイルです。

## シナリオファイルの形式

シナリオファイルは以下の列を持つCSVファイルです：

| 列名 | 説明 | 必須 |
|-----|------|-----|
| 操作ID | アクションの一意の識別子 | はい |
| 操作タイプ | 実行するアクションのタイプ | はい |
| 対象要素 | アクションの対象となる要素のセレクタ | 操作タイプによる |
| 入力値 | 入力するテキストや検証値 | 操作タイプによる |
| 待機時間 | アクション後の待機時間（秒） | いいえ |
| 説明 | アクションの説明（ログに表示） | いいえ |
| Excel出力 | このアクションのスクリーンショットをExcelに含めるか | いいえ |

## 操作タイプ

以下の操作タイプがサポートされています：

| 操作タイプ | 説明 | 対象要素 | 入力値 | 待機時間 |
|----------|------|---------|-------|---------|
| URL移動 | 指定したURLに移動 | 移動先のパス | - | オプション |
| テキスト入力 | 要素にテキストを入力 | 入力フィールドのセレクタ | 入力するテキスト | オプション |
| クリック | 要素をクリック | クリックする要素のセレクタ | - | オプション |
| 強制クリック | JavaScriptを使用して要素を強制的にクリック | クリックする要素のセレクタ | - | オプション |
| JSクリック | JavaScriptを使用して要素をクリック | クリックする要素のセレクタ | - | オプション |
| 選択 | ドロップダウンから選択 | セレクト要素のセレクタ | 選択する値 | オプション |
| 待機 | 指定した秒数待機 | - | - | 必須 |
| アサート | 要素の存在や値を検証 | 検証する要素のセレクタ | 期待される値 | オプション |
| スクリプト実行 | JavaScriptを実行 | 実行するJavaScriptコード | 期待される戻り値（オプション） | オプション |

## セレクタの書き方

対象要素には以下の形式のセレクタを指定できます：

- ID: `#login-button`
- クラス名: `.submit-button`
- XPath: `//div[@id='content']/form/input`
- CSS: `form > input[type='submit']`
- 明示的なXPath: `xpath=//div[@id='content']`
- 明示的なCSS: `css=form > input[type='submit']`

## 特殊構文

入力値には以下の特殊構文を使用できます：

- `${user.キー名}`: ユーザー設定ファイルから値を取得します。例: `${user.app_username}`、`${user.app_password}`
- `${user.username}`: `app_username`のエイリアス
- `${user.password}`: `app_password`のエイリアス

## Excel出力について

「Excel出力」列には以下の値を指定できます：

- `yes` または `y`: このアクションのスクリーンショットをExcelレポートに含めます
- 空白または`no`: スクリーンショットは保存されますが、Excelレポートには含まれません

例：
```csv
操作ID,操作タイプ,対象要素,入力値,待機時間,説明,Excel出力
1,URL移動,/login,,2,ログインページに移動,yes
2,テキスト入力,#username,${user.app_username},,ユーザー名を入力,y
3,テキスト入力,#password,${user.app_password},,パスワードを入力,
```

## シナリオファイルの例

```csv
操作ID,操作タイプ,対象要素,入力値,待機時間,説明,Excel出力
1,URL移動,/login,,2,ログインページに移動,yes
2,テキスト入力,#username,${user.app_username},,ユーザー名を入力,no
3,テキスト入力,#password,${user.app_password},,パスワードを入力,no
4,クリック,#login-button,,,ログインボタンをクリック,yes
5,アサート,#welcome-message,ようこそ,,ログイン成功の確認,yes
```

この例では、ログインページに移動し、ユーザー名とパスワードを入力してログインボタンをクリックし、ログイン成功を確認します。
また、ログインページへの移動、ログインボタンのクリック、ログイン成功の確認時のスクリーンショットがExcelレポートに含まれます。
## スクロール機能

クリック操作（`クリック`および`強制クリック`）では、要素が画面外にある場合でも自動的にその要素までスクロールしてからクリックを実行します。詳細については[スクロール機能](scroll_feature.md)のドキュメントを参照してください。
